<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>App Builder - ATProto</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>build the Web you want</h1>
    </header>
    <main>
      <section id="block-one">
        <h2 style="font-family: var(--ff-heading); font-size: var(--fs-700); margin-bottom: 1rem;">Let's get started</h2>
        <p>
          A decentralized web app is any web page or application where: 1) you
          login with an identity that you own, and 2) the app uses data from a
          source that you own.
        </p>
      </section>

      <section id="block-two">
        <h2 style="font-family: var(--ff-heading); font-size: var(--fs-700); margin-bottom: 1rem;">Some examples are:</h2>
        <ul style="margin: 0; padding-left: 1.5rem;">
          <li style="margin-bottom: 0.75rem;">
            A personal app that you use to keep track of music you've listened
            to, and music you want to check out.
          </li>
          <li style="margin-bottom: 0.75rem;">
            A grocery list app that you can share with a roommate or spouse.
          </li>
          <li>
            An app shared with a group of people who are planning an event
            together.
          </li>
        </ul>
      </section>

      <section id="block-one">
        <p style="margin-bottom: 1rem;">
          There are four necessary functions of an ATProtocol application, and
          in the next step we will build an app while walking through each item.
          They are:
        </p>
        <ol style="margin: 0; padding-left: 1.5rem;">
          <li style="margin-bottom: 0.75rem;">
            <strong>Login/logout:</strong> this step will be mostly handled for
            you by existing libraries.
          </li>
          <li style="margin-bottom: 0.75rem;">
            <strong>Retrieve data from one or more Personal Data Servers:</strong>
            think about what data you need in your app. We'll define it and
            create it in this step, then set up a means for the app to retrieve
            it.
          </li>
          <li style="margin-bottom: 0.75rem;">
            <strong>Use retrieved data to create a user interface (UI):</strong>
            in this step, you determine how you will display the dataâ€”it could
            be displayed directly (e.g. a todo list that shows every item by
            default), or used to create a list of options (e.g. a dropdown menu
            that allows you to select an option), or you could use the data to
            display more information related to it (e.g. a list of movies you
            want to see could be used to show local movie times or streaming
            options).
          </li>
          <li>
            <strong>Interact with your data:</strong> in the UI, you could
            select and rearrange items to change what you see and how it's
            displayed, and you could also have options to update or delete items
            (which will make updates directly to your Personal Data Server).
          </li>
        </ol>
      </section>

      <div id="get-started-container">
        <button type="button" id="start-building-btn" class="get-started-button">
          Start building
        </button>
      </div>

      <!-- Wizard Container (initially hidden) -->
      <div id="wizard-container" class="wizard-container" style="display: none;">

        <!-- Progress Indicator -->
        <div class="wizard-progress">
          <div class="wizard-progress-bar">
            <div class="wizard-progress-fill" id="wizard-progress-fill" style="width: 0%;"></div>
          </div>
          <p class="wizard-progress-text" id="wizard-progress-text">Step 1 of 6: App Information</p>
        </div>

        <!-- Step Container (content changes based on current step) -->
        <div id="wizard-step-content" class="wizard-step-content">
          <!-- Dynamic step content inserted here by JavaScript -->
        </div>

        <!-- Navigation Buttons -->
        <div class="wizard-nav">
          <button type="button" id="wizard-save" class="wizard-button wizard-button-secondary">
            Save Progress
          </button>
          <div class="wizard-nav-main">
            <button type="button" id="wizard-back" class="wizard-button wizard-button-secondary" disabled>
              Back
            </button>
            <button type="button" id="wizard-next" class="wizard-button wizard-button-primary">
              Next
            </button>
          </div>
        </div>
      </div>
    </main>

    <!-- Resume Dialog -->
    <dialog id="resume-dialog" class="wizard-dialog">
      <button type="button" class="dialog-close" id="resume-close-x">&times;</button>
      <div class="dialog-content">
        <h2>Resume Your Work?</h2>
        <p>We found a saved wizard session from <span id="resume-date"></span>.</p>
        <div class="dialog-buttons">
          <button type="button" class="dialog-button" id="resume-continue">
            Resume Building
          </button>
          <button type="button" class="dialog-button" id="resume-start-fresh">
            Start Fresh
          </button>
          <button type="button" class="dialog-cancel" id="resume-cancel">
            Cancel
          </button>
        </div>
      </div>
    </dialog>

    <!-- Add/Edit Record Type Dialog -->
    <dialog id="edit-record-dialog" class="wizard-dialog">
      <button type="button" class="dialog-close" id="edit-record-close-x">&times;</button>
      <div class="dialog-content">
        <h2 id="edit-record-title">Add Record Type</h2>
        <form id="edit-record-form" class="wizard-form">
          <div class="wizard-field">
            <label for="record-name">Name *</label>
            <input type="text" id="record-name" class="wizard-input" required />
            <span class="wizard-field-help">
              Lowercase, no spaces (e.g., "todo", "post", "bookmark")
            </span>
          </div>

          <div class="wizard-field">
            <label for="record-description">Description</label>
            <textarea id="record-description" class="wizard-textarea" rows="2"></textarea>
          </div>

          <div class="dialog-buttons">
            <button type="submit" class="dialog-button">Save</button>
            <button type="button" class="dialog-cancel" id="cancel-record">Cancel</button>
          </div>
        </form>
      </div>
    </dialog>

    <!-- Add/Edit Field Dialog -->
    <dialog id="edit-field-dialog" class="wizard-dialog">
      <button type="button" class="dialog-close" id="edit-field-close-x">&times;</button>
      <div class="dialog-content">
        <h2 id="edit-field-title">Add Field</h2>
        <form id="edit-field-form" class="wizard-form">
          <div class="wizard-field">
            <label for="field-name">Name *</label>
            <input type="text" id="field-name" class="wizard-input" required />
            <span class="wizard-field-help">
              lowerCamelCase (e.g., "text", "createdAt", "isCompleted")
            </span>
          </div>

          <div class="wizard-field">
            <label for="field-type">Type *</label>
            <select id="field-type" class="wizard-select" required>
              <option value="string">String</option>
              <option value="boolean">Boolean</option>
              <option value="integer">Integer</option>
              <option value="bytes">Bytes</option>
              <option value="cid-link">CID Link</option>
              <option value="blob">Blob</option>
              <option value="array-string">Array of Strings</option>
              <option value="array-number">Array of Numbers</option>
              <option value="media-url">Media URL</option>
            </select>
          </div>

          <div class="wizard-field" id="field-media-type-container" style="display: none;">
            <label for="field-media-type">Media Type *</label>
            <select id="field-media-type" class="wizard-select">
              <option value="image">Image</option>
              <option value="audio">Audio</option>
              <option value="video">Video</option>
            </select>
            <span class="wizard-field-help">
              The type of media this URL will link to (for preview purposes)
            </span>
          </div>

          <div class="wizard-field" id="field-format-container" style="display: none;">
            <label for="field-format">Format</label>
            <select id="field-format" class="wizard-select">
              <option value="">None</option>
              <option value="datetime">Datetime</option>
              <option value="uri">URI</option>
              <option value="at-uri">AT-URI</option>
              <option value="did">DID</option>
            </select>
          </div>

          <div class="wizard-field" id="field-maxlength-container" style="display: none;">
            <label for="field-maxlength">Max Length</label>
            <input type="number" id="field-maxlength" class="wizard-input" min="1" />
          </div>

          <div class="wizard-field">
            <label for="field-description">Description</label>
            <textarea id="field-description" class="wizard-textarea" rows="2"></textarea>
          </div>

          <div class="wizard-field">
            <label class="wizard-checkbox-label">
              <input type="checkbox" id="field-required" />
              Required field
            </label>
          </div>

          <div class="dialog-buttons">
            <button type="submit" class="dialog-button">Save</button>
            <button type="button" class="dialog-cancel" id="cancel-field">Cancel</button>
          </div>
        </form>
      </div>
    </dialog>

    <!-- Add/Edit Query Dialog -->
    <dialog id="edit-query-dialog" class="wizard-dialog">
      <button type="button" class="dialog-close" id="edit-query-close-x">&times;</button>
      <div class="dialog-content">
        <h2 id="edit-query-title">Add Query Method</h2>
        <form id="edit-query-form" class="wizard-form">
          <div class="wizard-field">
            <label for="query-name">Name *</label>
            <input type="text" id="query-name" class="wizard-input" required />
            <span class="wizard-field-help">
              lowerCamelCase (e.g., "listTodos", "getPost", "searchBookmarks")
            </span>
          </div>

          <div class="wizard-field">
            <label for="query-description">Description</label>
            <textarea id="query-description" class="wizard-textarea" rows="2"></textarea>
          </div>

          <div class="wizard-field">
            <label for="query-returns-record">Returns Record Type *</label>
            <select id="query-returns-record" class="wizard-select" required>
              <!-- Options populated by JavaScript -->
            </select>
          </div>

          <div class="wizard-field">
            <label class="wizard-checkbox-label">
              <input type="checkbox" id="query-returns-list" checked />
              Returns a list (array) of records
            </label>
          </div>

          <div class="dialog-buttons">
            <button type="submit" class="dialog-button">Save</button>
            <button type="button" class="dialog-cancel" id="cancel-query">Cancel</button>
          </div>
        </form>
      </div>
    </dialog>

    <!-- Add/Edit Procedure Dialog -->
    <dialog id="edit-procedure-dialog" class="wizard-dialog">
      <button type="button" class="dialog-close" id="edit-procedure-close-x">&times;</button>
      <div class="dialog-content">
        <h2 id="edit-procedure-title">Add Procedure Method</h2>
        <form id="edit-procedure-form" class="wizard-form">
          <div class="wizard-field">
            <label for="procedure-name">Name *</label>
            <input type="text" id="procedure-name" class="wizard-input" required />
            <span class="wizard-field-help">
              lowerCamelCase (e.g., "createTodo", "updatePost", "deleteBookmark")
            </span>
          </div>

          <div class="wizard-field">
            <label for="procedure-description">Description</label>
            <textarea id="procedure-description" class="wizard-textarea" rows="2"></textarea>
          </div>

          <div class="wizard-field">
            <label for="procedure-input-record">Input Record Type</label>
            <select id="procedure-input-record" class="wizard-select">
              <option value="">None</option>
              <!-- Options populated by JavaScript -->
            </select>
          </div>

          <div class="wizard-field">
            <label for="procedure-output-type">Output Type *</label>
            <select id="procedure-output-type" class="wizard-select" required>
              <option value="success">Success Response</option>
              <option value="record">Record</option>
            </select>
          </div>

          <div class="wizard-field" id="procedure-output-record-container" style="display: none;">
            <label for="procedure-output-record">Output Record Type</label>
            <select id="procedure-output-record" class="wizard-select">
              <!-- Options populated by JavaScript -->
            </select>
          </div>

          <div class="dialog-buttons">
            <button type="submit" class="dialog-button">Save</button>
            <button type="button" class="dialog-cancel" id="cancel-procedure">Cancel</button>
          </div>
        </form>
      </div>
    </dialog>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
